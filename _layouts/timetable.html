<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ page.title }}</title>
  <style>
    .entry { margin: 10px 0; }
    .year-month { font-weight: bold; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>{{ page.title }}</h1>

  <input type="text" id="search" placeholder="输入关键词搜索..." oninput="filterEntries()">
  
  <div id="timetable-entries">
    {% assign sorted = site.timetable | sort: 'date' | reverse %}
    {% assign grouped = sorted | group_by_exp:"item", "item.date | date: '%Y-%m'" %}

    {% for group in grouped %}
      <div class="year-month">{{ group.name }}</div>
      <ul>
      {% for post in group.items %}
        <li class="entry">
          <a href="{{ post.url }}">{{ post.title }}</a> - {{ post.date | date: "%Y-%m-%d" }}
          <div class="content" style="display: none;">{{ post.content | strip_html | downcase }}</div>
        </li>
      {% endfor %}
      </ul>
    {% endfor %}
  </div>

  <script>
    function filterEntries() {
      const input = document.getElementById('search').value.toLowerCase();
      const entries = document.querySelectorAll('#timetable-entries .entry');

      entries.forEach(entry => {
        const text = entry.textContent.toLowerCase();
        const content = entry.querySelector('.content').textContent.toLowerCase();
        if (text.includes(input) || content.includes(input)) {
          entry.style.display = '';
        } else {
          entry.style.display = 'none';
        }
      });
    }
  </script>
</body>
</html>
